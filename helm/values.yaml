# Global configuration
global:
  imageRegistry: gcr.io/axiomatic-fiber-479102-k7
  imageTag: "latest"
  imagePullPolicy: IfNotPresent
  storageClass: "standard"

# Microservices configuration
microservices:
  # API Gateway
  apiGateway:
    enabled: true
    name: api-gateway
    image:
      repository: api-gateway
      tag: ""
    replicaCount: 2
    service:
      type: ClusterIP
      port: 80
      targetPort: 8080
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi
    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 10
      targetCPUUtilizationPercentage: 70

  # User Service
  userService:
    enabled: true
    name: user-service
    image:
      repository: user-service
      tag: ""
    replicaCount: 1
    service:
      type: ClusterIP
      port: 80
      targetPort: 8700
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi
    database:
      name: user_db
      enabled: true

  # Product Service
  productService:
    enabled: true
    name: product-service
    image:
      repository: product-service
      tag: ""
    replicaCount: 2
    service:
      type: ClusterIP
      port: 80
      targetPort: 8400
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi
    database:
      name: product_db
      enabled: true

  # Order Service
  orderService:
    enabled: true
    name: order-service
    image:
      repository: order-service
      tag: ""
    replicaCount: 1
    service:
      type: ClusterIP
      port: 80
      targetPort: 8200
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi
    database:
      name: order_db
      enabled: true

  # Payment Service
  paymentService:
    enabled: true
    name: payment-service
    image:
      repository: payment-service
      tag: ""
    replicaCount: 2
    service:
      type: ClusterIP
      port: 80
      targetPort: 8600
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi
    database:
      name: payment_db
      enabled: true

  # Shipping Service
  shippingService:
    enabled: true
    name: shipping-service
    image:
      repository: shipping-service
      tag: ""
    replicaCount: 1
    service:
      type: ClusterIP
      port: 80
      targetPort: 8800
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi
    database:
      name: shipping_db
      enabled: true

  # Favourite Service
  favouriteService:
    enabled: true
    name: favourite-service
    image:
      repository: favourite-service
      tag: ""
    replicaCount: 1
    service:
      type: ClusterIP
      port: 80
      targetPort: 8500
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi
    database:
      name: favourite_db
      enabled: true

# Infrastructure Services
infrastructure:
  # Service Discovery (Eureka)
  serviceDiscovery:
    enabled: true
    name: service-discovery
    image:
      repository: service-discovery
      tag: ""
    replicaCount: 1
    service:
      type: ClusterIP
      port: 8761
      targetPort: 8761
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi

  # Cloud Config
  cloudConfig:
    enabled: true
    name: cloud-config
    image:
      repository: cloud-config
      tag: ""
    replicaCount: 1
    service:
      type: ClusterIP
      port: 8888
      targetPort: 8888
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi

  # Proxy Client
  proxyClient:
    enabled: true
    name: proxy-client
    image:
      repository: proxy-client
      tag: ""
    replicaCount: 1
    service:
      type: ClusterIP
      port: 80
      targetPort: 8080
    resources:
      requests:
        cpu: 300m
        memory: 768Mi
      limits:
        cpu: 750m
        memory: 1536Mi

# Database Configuration
postgresql:
  enabled: true
  auth:
    postgresPassword: "ecommerce123"
    username: "ecommerce"
    password: "ecommerce123"
    database: "ecommerce_db"
  primary:
    persistence:
      enabled: true
      size: 8Gi
      storageClass: ""
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 1000m
        memory: 2Gi

# Monitoring Stack
monitoring:
  enabled: true
  
  prometheus:
    enabled: true
    server:
      persistentVolume:
        enabled: true
        size: 8Gi
      resources:
        requests:
          cpu: 500m
          memory: 1Gi
        limits:
          cpu: 1000m
          memory: 2Gi
    
  grafana:
    enabled: true
    persistence:
      enabled: true
      size: 1Gi
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 200m
        memory: 256Mi
    adminPassword: "admin123"

  loki:
    enabled: true
    persistence:
      enabled: true
      size: 10Gi
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 1000m
        memory: 1Gi

# Security Configuration
security:
  podSecurityStandards:
    enabled: true
    enforce: "restricted"
  
  networkPolicies:
    enabled: true
    denyAll: true
    allowMonitoring: true
  
  sealedSecrets:
    enabled: true
    controllerNamespace: "sealed-secrets"

# Autoscaling Configuration
autoscaling:
  keda:
    enabled: true
    namespace: "keda"
  
  hpa:
    enabled: true
    defaultTargetCPU: 70
    defaultTargetMemory: 80

# Ingress Configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
  hosts:
    - host: api.ecommerce.local
      paths:
        - path: /
          pathType: Prefix
          service: api-gateway
  tls:
    - secretName: ecommerce-tls
      hosts:
        - api.ecommerce.local

# Testing Configuration
testing:
  jmeter:
    enabled: false
    threads: 100
    rampUp: 120
    loops: 10
    
# Service Mesh (Future)
serviceMesh:
  istio:
    enabled: false
    injection: true
    
# Backup Configuration
backup:
  enabled: true
  schedule: "0 2 * * *"
  retention: 7